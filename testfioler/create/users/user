# Active Directory User Creation Script

# Parameters
$Username = Read-Host "Enter username"
$FirstName = Read-Host "Enter first name"
$LastName = Read-Host "Enter last name"
$Password = ConvertTo-SecureString "Password01!" -AsPlainText -Force
$Domain = "drageide.com"
$Email = "$FirstName.$LastName@$Domain"
$OU = "OU=brukere,OU=users,OU=drageideou,DC=drageide,DC=com"

# Create the user
New-ADUser `
    -SamAccountName $Username `
    -UserPrincipalName "$Username@$Domain" `
    -Name "$FirstName $LastName" `
    -GivenName $FirstName `
    -Surname $LastName `
    -EmailAddress $Email `
    -Path $OU `
    -AccountPassword $Password `
    -Enabled $true `
    -PasswordNeverExpires $false `
    -ChangePasswordAtLogon $false

Write-Host "User $Username created successfully in OU: $OU"
